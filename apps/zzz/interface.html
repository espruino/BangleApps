<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css" />
  <link rel="stylesheet" href="../../css/spectre.min.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet-geosearch@3.6.0/dist/geosearch.css"/>
  <style>
    body {
      padding: 0;
      margin: 0;
    }
    html, body, #map, #mapsLoaded, #mapContainer {
      position: relative;
      height: 100%;
      width: 100%;
    }
    #map { z-index: 1; }
    #controls {
      padding: 10px;
      margin: 10px;
      border: 1px solid black;
      position:absolute;
      right:0px;top:0px;
      background-color: rgb(255, 255, 255);
      z-index: 100;
    }
    #maptiles {
      width: 256px;
      height: 256px;
    }
    .tile-title {
      font-weight:bold;
      font-size: 125%;
    }
    .tile-map {
      width: 128px;
      height: 128px;
    }
  </style>
</head>
<body>
<div id="mapsLoadedContainer"></div>
<div id="mapContainer">
  <div id="map"></div>
  <div id="controls">
    <div style="display:inline-block;text-align:left;vertical-align: top;" id="3bitdiv">
      <input type="checkbox" id="3bit"></input><span>3 bit</span><br>
      <input type="checkbox" id="preview"><span>Preview</span>
    </div>
    <div class="form-group" style="display:inline-block;">
      <select class="form-select" id="mapSize">
        <option value="4">Small (4x4)</option>
        <option value="5" selected>Medium (5x5)</option>
        <option value="7">Large (7x7)</option>
        <option value="10">XL (10x10)</option>
        <option value="15">XXL (15x15)</option>
      </select>
    </div>
    <button id="getmap" class="btn btn-primary">Get Map</button>
    <button class="btn" onclick="showLoadedMaps()">Map List</button><br/>
    <canvas id="maptiles" style="display:none"></canvas>
    <div id="uploadbuttons" style="display:none">
      <button id="upload" class="btn btn-primary">Upload</button>
      <button id="cancel" class="btn">Cancel</button>
      <span id="mapstats"></span>
    </div>
  </div>
</div>

<script src="../../core/lib/interface.js"></script>
<script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"></script>
<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
<script src="../../webtools/heatshrink.js"></script>
<script src="../../webtools/imageconverter.js"></script>
<script src="https://unpkg.com/leaflet-geosearch@3.6.0/dist/bundle.min.js"></script>
<script src="imagefilter.js"></script>
<script>
  var TILESIZE = 96;
  var OSMTILESIZE = 256;
  var TILELAYER = 'https://tile.openstreetmap.org/{z}/{x}/{y}.png';
  var PREVIEWTILELAYER = 'https://tile.openstreetmap.org/{z}/{x}/{y}.png';
  var loadedMaps = [];
  var bangleTileLayer = L.tileLayer(TILELAYER, {
    maxZoom: 18,
    attribution: 'Map data &copy; <a href="https://openstreetmap.org/copyright">OpenStreetMap</a> contributors</a>'
  });
  var previewTileLayer = L.tileLayer(PREVIEWTILELAYER, {
    maxZoom: 18,
    attribution: 'Map data &copy; <a href="https://openstreetmap.org/copyright">OpenStreetMap</a> contributors</a>'
  });
  var map = L.map('map').locate({setView: true, maxZoom: 16, enableHighAccuracy:true});
  previewTileLayer.addTo(map);

  // Add a circular red zone with a radius of 500 meters
  var redZoneCenter = [21.331115, 39.946196]; // Example center coordinates for the red zone, replace with your desired center
  var redZoneRadius = 50; // Radius in meters
  var redZoneCircle = L.circle(redZoneCenter, {
    color: 'red',
    fillColor: 'red',
    fillOpacity: 0.5,
    radius: redZoneRadius
  }).addTo(map);

  const searchProvider = new window.GeoSearch.OpenStreetMapProvider();
  const searchControl = new GeoSearch.GeoSearchControl({
    provider: searchProvider,
    style: 'button',
    updateMap: true,
    autoClose: true,
    showMarker: false,
    keepResult: true,
    autoComplete: false
  });
  map.addControl(searchControl);

  function onInit(device) {
    if (device && device.info && device.info.g) {
      if (device.info.g.bpp==3) {
        document.getElementById("3bit").checked = true;
      }
    }
    showLoadedMaps();
  }

  function showLoadedMaps() {
    // Function code for showing loaded maps
  }

  function onMapDelete(mapNumber) {
    // Function code for deleting a map
  }

  function showMap() {
    // Function code for showing the map
  }

  var mapFiles = [];

  function tilesLoaded(ctx, width, height, mapImageFile) {
    // Function code for loading tiles
  }

  document.getElementById("getmap").addEventListener("click", function() {
    // Event listener code for getting a map
  });

  document.getElementById("upload").addEventListener("click", function() {
    // Event listener code for uploading
  });

  document.getElementById("cancel").addEventListener("click", function() {
    // Event listener code for canceling
  });

</script>
</body>
</html>
