let counterInterval,buzzInterval,btn4WatchId,btn5WatchId,state="unset",counter=0,setValue=0;const APP_TITLE="TIMER",DEBOUNCE=50;function buzzAndBeep(){Bangle.buzz(1e3,1).then(()=>{Bangle.beep(200,4e3)})}function outOfTime(){counterInterval||(E.showMessage("Time's up\n\nBTN2 to reset","TIMER"),buzzAndBeep(),buzzInterval=setInterval(buzzAndBeep,5e3))}function draw(){const e=Math.floor(counter/60),t=counter-60*e,n=t<10?"0"+t:t.toString();g.clear(),g.setFontAlign(0,0),g.setFont("6x8",8),g.drawString(`${e}:${n}`,120,120),g.flip()}function countDown(){if(counter<=0)return counterInterval&&(clearInterval(counterInterval),counterInterval=void 0),void outOfTime();counter--,draw()}function startTimer(){counterInterval||(stopTouchWatch(),countDown(),counterInterval=setInterval(countDown,1e3))}function clearIntervals(){counterInterval&&(clearInterval(counterInterval),counterInterval=void 0),buzzInterval&&(clearInterval(buzzInterval),buzzInterval=void 0)}function getDelta(){return counter<30?1:counter<60?5:10}function increaseTimer(e){const t="number"==typeof e?e:getDelta();counter+=t,setValue=counter,"unset"===state&&(state="set"),draw(),setTimeout(()=>{BTN5.read()&&increaseTimer()},50)}function decreaseTimer(e){const t="number"==typeof e?e:getDelta();counter=Math.max(0,counter-t),setValue=counter,draw(),setTimeout(()=>{BTN4.read()&&decreaseTimer()},50)}function reset(e){counter=e,setTouchWatch(),clearIntervals(),draw()}function handleBtn2(){"unset"!==state&&("set"===state?(state="started",startTimer()):"started"===state&&(state="set",reset(setValue)))}function setTouchWatch(){btn4WatchId=setWatch(decreaseTimer,BTN4,{debounce:50,repeat:!0}),btn5WatchId=setWatch(increaseTimer,BTN5,{debounce:50,repeat:!0})}function stopTouchWatch(){btn4WatchId&&(clearWatch(btn4WatchId),btn4WatchId=void 0),btn5WatchId&&(clearWatch(btn5WatchId),btn5WatchId=void 0)}setWatch(handleBtn2,BTN2,{debounce:500,repeat:!0,edge:"falling"}),setWatch(()=>decreaseTimer(1),BTN1,{debounce:50,repeat:!0}),setWatch(()=>increaseTimer(1),BTN3,{debounce:50,repeat:!0}),reset(0),E.showMessage("Tap right, time UP\n\nleft time DOWN","TIMER");
