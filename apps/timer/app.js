let counterInterval,buzzInterval,btn4WatchId,btn5WatchId,counter=0,setValue=0;const DEBUG=!1,APP_TITLE="TIMER",DEBOUNCE=50;function buzzAndBeep(){Bangle.buzz(1e3,1).then(()=>{Bangle.beep(200,4e3)})}function outOfTime(){counterInterval||(E.showMessage("Time's up\n\nBTN2 to reset","TIMER"),buzzAndBeep(),buzzInterval=setInterval(buzzAndBeep,5e3))}function draw(){const e=Math.floor(counter/60),t=counter-60*e,n=t<10?"0"+t:t.toString();g.clear(),g.setFontAlign(0,0),g.setFont("6x8",8),g.drawString(`${e}:${n}`,120,120)}function countDown(){if(counter<=0)return counterInterval&&(clearInterval(counterInterval),counterInterval=void 0),void outOfTime();counter--,draw()}function startTimer(){counterInterval||(stopTouchWatch(),setValue=counter,countDown(),counterInterval=setInterval(countDown,1e3))}function clearIntervals(){counterInterval&&(clearInterval(counterInterval),counterInterval=void 0),buzzInterval&&(clearInterval(buzzInterval),buzzInterval=void 0)}let lastReleaseTime=0;const THRESHOLD1=5e3,THRESHOLD2=7500;function getDelta(){const e=Date.now()-lastReleaseTime;return 0===lastReleaseTime||e<5e3?1:e<7500?10:30}function handleBtnPress(e,t){setTimeout(()=>{e.read()?t():lastReleaseTime=Date.now()},50)}function increaseTimer(){const e=getDelta();counter+=e,"unset"===state&&(state="set"),draw(),handleBtnPress(BTN5,increaseTimer)}function decreaseTimer(){const e=getDelta();counter=Math.max(0,counter-e),draw(),handleBtnPress(BTN4,decreaseTimer)}function reset(e){counter=e,setTouchWatch(),clearIntervals(),draw()}let state="unset";function changeState(){"unset"!==state&&("set"===state?(state="started",startTimer()):"started"===state&&(state="set",reset(setValue)))}function setTouchWatch(){btn4WatchId=setWatch(decreaseTimer,BTN4,{debounce:50,repeat:!0}),btn5WatchId=setWatch(increaseTimer,BTN5,{debounce:50,repeat:!0})}function stopTouchWatch(){btn4WatchId&&(clearWatch(btn4WatchId),btn4WatchId=void 0),btn5WatchId&&(clearWatch(btn5WatchId),btn5WatchId=void 0)}setWatch(changeState,BTN2,{debounce:1e3,repeat:!0,edge:"falling"}),reset(0),E.showMessage("Tap right, time UP\n\nleft time DOWN","TIMER");
